{% extends "layout.html" %}

{% block title %}
    Home
{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h1>Welcome to GuardianScan</h1>
        <div class="row">
            <div class="col">
                <p>¡Bienvenido a GuardianScan! Este es mi proyecto final para el curso CS50 de Harvard University.</p>
                <p>GuardianScan es una herramienta de análisis de seguridad web que puede detectar vulnerabilidades comunes como XSS y SQLi en sitios web.</p>
            </div>
            <div class="col">
                <form method="POST">
                    <input type="text" name="url" placeholder="Ej: http://localhost:5001/xss?q=" required style="width: 300px;">
                    <button type="submit">Escanear</button>
                </form>
            
                {% if result %}
                <div style="margin-top: 20px;">
                    <h3>Resultados para {{ result.url }}:</h3>
                    <p>XSS Vulnerable: 
                        <span class="{% if result.xss %}vulnerable{% else %}safe{% endif %}">
                            {% if result.xss %}🚫 Sí{% else %}✅ No{% endif %}
                        </span>
                    </p>
                    <div name="xss_payload" style="margin-left: 20px;">
                        <p>Payload: {{ result.xss_payload }}</p>
                    </div>
                    <p>SQLi Vulnerable: 
                        <span class="{% if result.sqli %}vulnerable{% else %}safe{% endif %}">
                            {% if result.sqli %}🚫 Sí{% else %}✅ No{% endif %}
                        </span>
                    </p>
                    <div name="sqli_payload" style="margin-left: 20px;">
                        <p>Payload: {{ result.sqli_payload }}</p>
                    </div>
                </div>
                {% endif %}

                <footer style="margin-top: 50px; color: #666;">
                    <small>⚠️ Solo escanee sitios con permiso explícito.</small>
                </footer>
            </div>
        </div>
    </div>
{% endblock %}