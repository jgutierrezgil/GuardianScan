{% extends "layout.html" %}

{% block title %}
    Home
{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h1>Welcome to GuardianScan</h1>
        <div class="row">
            <div class="col">
                <p>¬°Bienvenido a GuardianScan! Este es mi proyecto final para el curso CS50 de Harvard University.</p>
                <p>GuardianScan es una herramienta de an√°lisis de seguridad web que puede detectar vulnerabilidades comunes como XSS y SQLi en sitios web.</p>
            </div>
            <div class="col">
                <form method="POST">
                    <input type="text" name="url" placeholder="Ej: http://localhost:5001/xss?q=" required style="width: 300px;">
                    <div class="mt-2">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payload_type" id="default" value="default" checked>
                            <label class="form-check-label" for="default">
                                Usar payloads por defecto
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payload_type" id="custom" value="custom">
                            <label class="form-check-label" for="custom">
                                Usar payload personalizado
                            </label>
                        </div>
                        <div id="custom_payload_div" class="mt-2" style="display: none;">
                            <input type="text" name="custom_payload" placeholder="Ingrese su payload personalizado" style="width: 300px;">
                        </div>
                    </div>
                    <button type="submit" class="mt-2">Escanear</button>
                </form>
                <script>
                    document.querySelectorAll('input[name="payload_type"]').forEach((elem) => {
                        elem.addEventListener("change", function(event) {
                            var customDiv = document.getElementById("custom_payload_div");
                            customDiv.style.display = event.target.value === "custom" ? "block" : "none";
                        });
                    });
                </script>
            
                {% if result %}
                <div style="margin-top: 20px;">
                    <h3>Resultados para {{ result.url }}:</h3>
                    <p>XSS Vulnerable: 
                        <span class="{% if result.xss %}vulnerable{% else %}safe{% endif %}">
                            {% if result.xss %}üö´ S√≠{% else %}‚úÖ No{% endif %}
                        </span>
                    </p>
                    {% if result.xss %}
                    <div name="xss_payload" style="margin-left: 20px;">
                        <p>Payloads exitosos:</p>
                        <ul>
                        {% for payload in result.xss %}
                            <li>{{ payload }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    <p>SQLi Vulnerable: 
                        <span class="{% if result.sqli %}vulnerable{% else %}safe{% endif %}">
                            {% if result.sqli %}üö´ S√≠{% else %}‚úÖ No{% endif %}
                        </span>
                    </p>
                    {% if result.sqli %}
                    <div name="sqli_payload" style="margin-left: 20px;">
                        <p>Payloads exitosos:</p>
                        <ul>
                            {% for payload in result.sqli %}
                                <li>{{ payload }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

                <footer style="margin-top: 50px; color: #666;">
                    <small>‚ö†Ô∏è Solo escanee sitios con permiso expl√≠cito.</small>
                </footer>
            </div>
        </div>
    </div>
{% endblock %}